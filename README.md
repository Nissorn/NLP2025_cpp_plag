# Introduction

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö "CPP Plagiarism Detection" ‡∏°‡∏µ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Source Code C++ 2 ‡∏ä‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏à‡∏≤‡∏Å Similarity Score ‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Structural Similarity

‡πÅ‡∏Å‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ CodeBERT ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Fine-tuning ‡∏ö‡∏ô‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏î‡πâ‡∏ß‡∏¢ Architecture ‡πÅ‡∏ö‡∏ö Siamese Network ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Embedding Vector ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î C++ ‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ Cosine Similarity ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏ú‡∏• ‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ Tree-sitter ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏ú‡πà‡∏≤‡∏ô Abstract Syntax Tree (AST) ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û

# Methodology

### **System Pipeline Overview**

‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡πÜ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

1. **‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Preparation):**
    - **1.1 ‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô:** ‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• `POJ-104` ‡∏à‡∏≤‡∏Å `code_x_glue` ‡∏Ç‡∏≠‡∏á Google
    - **1.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (Pairing Strategy):** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏π‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 10,000 ‡∏Ñ‡∏π‡πà ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô (Clone) ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô (Non-clone) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡∏Ñ‡∏£‡∏∂‡πà‡∏á
    - **1.3 ‡πÅ‡∏ö‡πà‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:** ‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∏‡∏î Train (70%), Validation (15%), ‡πÅ‡∏•‡∏∞ Test (15%)
2. **‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Preprocessing):**
    - **2.1 ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î (Code Normalization):** ‡∏•‡∏ö‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå, ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Whitespace, ‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á Keywords ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
    - **2.1 ‡∏Å‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î Abstract Syntax Tree (AST):** ‡πÉ‡∏ä‡πâ `Tree-sitter` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏Ñ‡πâ‡∏î C++ ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Tree ‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏±‡∏î Node Types ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Feature
3. **‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ù‡∏∂‡∏Å‡∏™‡∏≠‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• (Model Training):**
    - **3.1 ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÇ‡∏°‡πÄ‡∏î‡∏•:** ‡πÉ‡∏ä‡πâ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏ö‡∏ö Siamese Network ‡πÇ‡∏î‡∏¢‡∏°‡∏µ `microsoft/codebert-base` ‡∏ó‡∏µ‡πà‡πÅ‡∏ä‡∏£‡πå‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô Encoder
    - **3.2 ‡∏Å‡∏≤‡∏£ Fine-tuning:** ‡∏ù‡∏∂‡∏Å‡∏™‡∏≠‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ö‡∏ô‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÑ‡∏ß‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ CodeBERT ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Embedding Vector ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î C++
4. **‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• (Detection & Evaluation):**
    - **4.1 ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Embeddings:** ‡∏ô‡∏≥‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏ó‡∏µ‡πà Fine-tune ‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á Embedding Vector ‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡∏ä‡∏∏‡∏î Train/Validation/Test
    - **4.2 ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á:** ‡πÉ‡∏ä‡πâ **Cosine Similarity** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Embedding ‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏π‡πà
    - **4.3 ‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Threshold ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°:** ‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏î Validation ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô (Threshold) ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤ F1-Score ‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
    - **4.4 ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•:** ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏ô‡∏ä‡∏∏‡∏î Test ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Threshold ‡∏ó‡∏µ‡πà‡∏´‡∏≤‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å‡∏ï‡πà‡∏≤‡∏á ‡πÜ (Accuracy, Precision, Recall, F1-Score, AUC)

# Setting Environment and Dependencies

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏î‡∏±‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:

- **Machine Learning & Data:** `torch`, `transformers`, `datasets`, `scikit-learn`
- **Data Handling:** `numpy`, `pandas`
- **AST Parsing:** `tree-sitter==0.20.4`
- **Utilities:** `matplotlib`, `seaborn`, `tqdm`

# Data Preparation

### **‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô (Source Dataset)**

- ‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• **POJ-104** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á **CodeXGLUE benchmark** (`google/code_x_glue_cc_clone_detection_poj104`)
- ‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏°‡∏¥‡πà‡∏á 104 ‡∏Ç‡πâ‡∏≠ ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `id`, `code` (‡∏ã‡∏≠‡∏£‡πå‡∏™‡πÇ‡∏Ñ‡πâ‡∏î C++), ‡πÅ‡∏•‡∏∞ `label` (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ç‡∏≠‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤)

### **‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà (Pairing Strategy)**

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏π‡πà‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô **10,000 ‡∏Ñ‡∏π‡πà** ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏î‡∏∏‡∏•:

- **‡∏Ñ‡∏π‡πà‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô (Clone Pairs, Label=1):** 5,000 ‡∏Ñ‡∏π‡πà
    - **‡∏ô‡∏¥‡∏¢‡∏≤‡∏°:** ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤ *‡∏Ç‡πâ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô* ‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Clone ‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
    - **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á:** ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≠‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (‡∏°‡∏µ `label` ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô) ‡∏°‡∏≤‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ô
- **‡∏Ñ‡∏π‡πà‡πÑ‡∏°‡πà‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô (Non-clone Pairs, Label=0):** 5,000 ‡∏Ñ‡∏π‡πà
    - **‡∏ô‡∏¥‡∏¢‡∏≤‡∏°:** ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤ *‡∏Ñ‡∏ô‡∏•‡∏∞‡∏Ç‡πâ‡∏≠* ‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô Clone
    - **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á:** ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏°‡∏≤‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏°‡∏≤‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ô

*‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡∏ó‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏° ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏µ‡∏Å‡∏¢‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î*

### **‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Splitting)**

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 10,000 ‡∏Ñ‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏™‡πà‡∏ß‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `stratify=df['label']` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô 50/50 ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡∏∏‡∏î:

- **Train Set:** 7,000 ‡∏Ñ‡∏π‡πà (70%)
- **Validation Set:** 1,500 ‡∏Ñ‡∏π‡πà (15%)
- **Test Set:** 1,500 ‡∏Ñ‡∏π‡πà (15%)

# Preprocessing & Feature Engineering

### **‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î (Code Normalization)**

‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡∏¥‡∏ö‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏°‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `normalize_code` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°:

- ‡∏•‡∏ö‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÅ‡∏ö‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (`// ...`) ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î (`/* ... */`)
- ‡∏¢‡∏∏‡∏ö Whitespace ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
- ‡πÅ‡∏õ‡∏•‡∏á C++ Keywords ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡πÄ‡∏ä‡πà‡∏ô `INT`, `FOR`, `IF`) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

Example

```markdown
// Before
#include <iostream>
int main() {
    // Calculate sum
    int   sum = 0;
    FOR(int i=0; i<10; i++)  
        sum += i;
    return sum;
}

// After
#include <iostream> int main() { int sum = 0; for(int i=0; i<10; i++) sum += i; return sum; }
```

### **‡∏Å‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î Abstract Syntax Tree (AST)**

- **‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠:** ‡πÉ‡∏ä‡πâ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ `tree-sitter` ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô Parser ‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Tree ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
- **‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£:**
    1. ‡πÇ‡∏´‡∏•‡∏î Grammar ‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤ C++ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö `tree-sitter`
    2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `extract_ast_nodes` ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Parse ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Normalization ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á AST
    3. ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Traverse ‡πÑ‡∏õ‡∏ï‡∏≤‡∏° Node ‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÉ‡∏ô Tree ‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á Node (‡πÄ‡∏ä‡πà‡∏ô `function_call`, `for_loop`, `variable_decl`)
- **‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:** ‡πÅ‡∏°‡πâ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î AST ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡πÅ‡∏ï‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Input ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• `SiameseCodeBERT` ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏™‡∏≠‡∏ô ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô Feature ‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

## Manual AST vs Tree-Sitter Library

‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Regular Expression ‡∏™‡∏£‡πâ‡∏≤‡∏á AST ‡πÅ‡∏•‡∏∞ ‡πÉ‡∏ä‡πâ Library [Tree-Sitter](https://tree-sitter.github.io/tree-sitter/) ‡∏ã‡∏∂‡πà‡∏á‡πÉ‡∏ä‡πâParser‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á AST ‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡πÉ‡∏ä‡πâevaluation‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Plagiarism Detection ‡πÇ‡∏î‡∏¢‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ 

### Code Sample 1

```jsx
void main() {
    int a[200][200];
    int i, j, row, col, sum;
    scanf("%d %d", &row, &col);
    for(i = 0; i < row; i++) {
        for(j = 0; j < col; j++)
            scanf("%d", &a[i][j]);
    }
    if(col >= row) {
        for(i = 0; i < row; i++) {
            sum = 0;
            for(j = 0; j < col; j++)
                sum += a[i][j];
            printf("%d ", sum);
        }
    } else {
        for(j = 0; j < col; j++) {
            sum = 0;
            for(i = 0; i < row; i++)
                sum += a[i][j];
            printf("%d ", sum);
        }
    }
}
```

- Regex AST
    
    ```cpp
    for_loop_count_5 if_stmt_count_5 else_stmt_count_1 max_nesting_4 function_def_count_1 type_int_count_2 type_void_count_1 op_increment_count_3 op_decrement_count_3 op_less_eq_count_2 op_greater_eq_count_3 array_access_count_5 pointer_ops_count_3 stdio_count_5 statement_count_20 paren_complexity_15
    ```
    
    - Regex AST JSON_FROM
        
        ```cpp
        {
          "metrics": {
            "for_loop_count": 5,
            "if_stmt_count": 5,
            "else_stmt_count": 1,
            "function_def_count": 1,
            "type_int_count": 2,
            "type_void_count": 1,
            "op_increment_count": 3,
            "op_decrement_count": 3,
            "op_less_eq_count": 2,
            "op_greater_eq_count": 3,
            "array_access_count": 5,
            "pointer_ops_count": 3,
            "stdio_count": 5,
            "statement_count": 20
          },
          "complexity": {
            "max_nesting": 4,
            "paren_complexity": 15
          }
        }
        ```
        
- Tree-sitter AST
    
    ```cpp
    ts_translation_unit_count_1 ts_function_definition_count_1 ts_primitive_type_count_3 ts_function_declarator_count_1 ts_identifier_count_10 ts_parameter_list_count_1 ts___count_10 ts___count_10 ts_compound_statement_count_10 ts___count_10 ts_declaration_count_2 ts_array_declarator_count_2 ts___count_10 ts_number_literal_count_10 ts___count_10 ts___count_10 ts___count_10 ts_expression_statement_count_10 ts_call_expression_count_6 ts_argument_list_count_6 ts_string_literal_count_6 ts___count_10 ts_string_content_count_6 ts_pointer_expression_count_3 ts___count_3 ts_for_statement_count_10 ts_for_count_10 ts_assignment_expression_count_10 ts___count_10 ts_binary_expression_count_10 ts___count_4 ts_update_expression_count_10 ts____count_6 ts_subscript_expression_count_10 ts_subscript_argument_list_count_10 ts___count_10 ts_if_statement_count_5 ts_if_count_5 ts_condition_clause_count_5 ts____count_9 ts____count_4 ts___count_8 ts_break_statement_count_4 ts_break_count_4 ts_escape_sequence_count_4 ts____count_2 ts___count_2 ts_else_clause_count_1 ts_else_count_1 ts_max_depth_15 ts_control_for_statement_count_5 ts_control_if_statement_count_5 ts_control_else_clause_count_1 ts_func_function_definition_count_1 ts_func_function_declarator_count_1 ts_func_declaration_count_2 ts_expr_binary_expression_count_10 ts_expr_call_expression_count_6 ts_expr_assignment_expression_count_10 ts_stmt_expression_statement_count_10 ts_stmt_break_statement_count_4 ts_stmt_compound_statement_count_10
    ```
    
    - Tree-sitter AST JSON_FROM
        
        ```cpp
        {
          "tree_sitter_counts": {
            "structure": {
              "translation_unit_count": 1,
              "function_definition_count": 1,
              "function_declarator_count": 1,
              "parameter_list_count": 1,
              "compound_statement_count": 10
            },
            "types_and_declarations": {
              "primitive_type_count": 3,
              "identifier_count": 10,
              "declaration_count": 2,
              "array_declarator_count": 2
            },
            "statements": {
              "expression_statement_count": 10,
              "for_statement_count": 10,
              "if_statement_count": 5,
              "break_statement_count": 4,
              "else_clause_count": 1
            },
            "expressions": {
              "call_expression_count": 6,
              "assignment_expression_count": 10,
              "binary_expression_count": 10,
              "update_expression_count": 10,
              "subscript_expression_count": 10,
              "pointer_expression_count": 3
            },
            "literals_and_arguments": {
              "number_literal_count": 10,
              "string_literal_count": 6,
              "string_content_count": 6,
              "argument_list_count": 6,
              "subscript_argument_list_count": 10
            },
            "tokens_and_keywords": {
              "for_count": 10,
              "if_count": 5,
              "else_count": 1,
              "break_count": 4
            }
          },
          "complexity_metrics": {
            "max_depth": 15,
            "control_flow": {
              "for_statement_count": 5,
              "if_statement_count": 5,
              "else_clause_count": 1
            }
          },
          "semantic_counts": {
            "functions": {
              "function_definition_count": 1,
              "function_declarator_count": 1,
              "declaration_count": 2
            },
            "expressions": {
              "binary_expression_count": 10,
              "call_expression_count": 6,
              "assignment_expression_count": 10
            },
            "statements": {
              "expression_statement_count": 10,
              "break_statement_count": 4,
              "compound_statement_count": 10
            }
          }
        }
        ```
        

### Code Sample 2

```jsx
int main() {
    int k, n, m, num[100][100], sum;
    cin >> n >> m;
    for(int i = 0; i < n; i++) {
        for(int j = 0; j < m; j++)
            cin >> num[i][j];
    }
    for(int i = 0; i < n; i++) {
        sum = 0;
        for(int j = 0; j < m; j++)
            sum += num[i][j];
        cout << sum << " ";
    }
    return 0;
}
```

- Regex AST
    
    ```jsx
    function_def_count_1 for_loop_count_3 if_stmt_count_1 max_nesting_5 return_stmt_count_1 type_int_count_5 op_plus_eq_count_1 op_increment_count_3 op_logical_or_count_3 op_equals_count_3 array_access_count_3 iostream_count_5 statement_count_17 paren_complexity
    ```
    
    - Regex AST JSON FORM
        
        ```jsx
        {
          "metrics": {
            "for_loop_count": 3,
            "if_stmt_count": 1,
            "function_def_count": 1,
            "return_stmt_count": 1,
            "type_int_count": 5,
            "op_plus_eq_count": 1,
            "op_increment_count": 3,
            "op_logical_or_count": 3,
            "op_equals_count": 3,
            "array_access_count": 3,
            "iostream_count": 5,
            "statement_count": 17
          },
          "complexity": {
            "max_nesting": 5,
            "paren_complexity": "count_missing"
          }
        }
        ```
        
- Tree-sitter AST
    
    ```jsx
     ts_translation_unit_count_1 ts_function_definition_count_1 ts_primitive_type_count_5 ts_function_declarator_count_1 ts_identifier_count_10 ts_parameter_list_count_1 ts___count_5 ts___count_5 ts_compound_statement_count_5 ts___count_5 ts_declaration_count_4 ts___count_4 ts_array_declarator_count_2 ts___count_6 ts_number_literal_count_10 ts___count_6 ts___count_10 ts_expression_statement_count_9 ts_binary_expression_count_10 ts____count_4 ts____count_5 ts_for_statement_count_3 ts_for_count_3 ts_init_declarator_count_3 ts___count_4 ts___count_3 ts_update_expression_count_3 ts____count_3 ts_assignment_expression_count_2 ts_subscript_expression_count_4 ts_subscript_argument_list_count_4 ts_string_literal_count_1 ts___count_2 ts_string_content_count_1 ts_if_statement_count_1 ts_if_count_1 ts_condition_clause_count_1 ts____count_4 ts____count_3 ts___count_2 ts____count_1 ts___count_5 ts_return_statement_count_1 ts_return_count_1 ts_max_depth_15 ts_control_for_statement_count_3 ts_control_if_statement_count_1 ts_func_function_definition_count_1 ts_func_function_declarator_count_1 ts_func_declaration_count_4 ts_expr_binary_expression_count_10 ts_expr_assignment_expression_count_2 ts_stmt_expression_statement_count_9 ts_stmt_return_statement_count_1 ts_stmt_compound_statement_count_5
    
    ```
    
    - Tree-sitter AST JSON FORM
        
        ```jsx
        {
          "tree_sitter_counts": {
            "structure": {
              "translation_unit_count": 1,
              "function_definition_count": 1,
              "function_declarator_count": 1,
              "parameter_list_count": 1,
              "compound_statement_count": 5
            },
            "types_and_declarations": {
              "primitive_type_count": 5,
              "identifier_count": 10,
              "declaration_count": 4,
              "array_declarator_count": 2,
              "init_declarator_count": 3
            },
            "statements": {
              "expression_statement_count": 9,
              "for_statement_count": 3,
              "if_statement_count": 1,
              "return_statement_count": 1
            },
            "expressions": {
              "binary_expression_count": 10,
              "update_expression_count": 3,
              "assignment_expression_count": 2,
              "subscript_expression_count": 4
            },
            "literals_and_arguments": {
              "number_literal_count": 10,
              "string_literal_count": 1,
              "string_content_count": 1,
              "subscript_argument_list_count": 4
            },
            "tokens_and_keywords": {
              "for_count": 3,
              "if_count": 1,
              "return_count": 1,
              "condition_clause_count": 1
            }
          },
          "complexity_metrics": {
            "max_depth": 15,
            "control_flow": {
              "for_statement_count": 3,
              "if_statement_count": 1
            }
          },
          "semantic_counts": {
            "functions": {
              "function_definition_count": 1,
              "function_declarator_count": 1,
              "declaration_count": 4
            },
            "expressions": {
              "binary_expression_count": 10,
              "assignment_expression_count": 2
            },
            "statements": {
              "expression_statement_count": 9,
              "return_statement_count": 1,
              "compound_statement_count": 5
            }
          }
        }
        ```
        

| Metric | Manual AST (‡πÉ‡∏ä‡πâ Regex) | Tree-sitter AST |
| --- | --- | --- |
| F1-Score | 0.734 | 0.763 |
| Precision | 0.623 | 0.709 |
| Recall | 0.893 | 0.825 |
| Accuracy | 0.657 | 0.728 |
| Best Threshold | 0.024 | 0.091 |
| False Positives | 430 | 269 (‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤) |
| False Negatives | 85 (‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤) | 139 |

‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâLibrary Tree-sitter ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

# Model Architecture and Fine-tuning

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Sample ‡πÅ‡∏•‡∏∞ Problem

![chart.png](attachment:86b927e6-5d24-45cd-a7da-ef100faba915:chart.png)

‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ 10,000 pairs ‡πÅ‡∏•‡∏∞ 10 problems ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á 2 problems ‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏™‡∏∏‡πà‡∏°‡πÇ‡∏¢‡∏ô‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÄ‡∏•‡∏¢

### **‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏´‡∏•‡∏±‡∏Å (Core Model)**

- ‡πÉ‡∏ä‡πâ **CodeBERT** (`microsoft/codebert-base`) ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• Transformer ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Pre-train ‡∏°‡∏≤‡∏ö‡∏ô‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏°‡∏¥‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ
- ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á CodeBERT
    - Pre-trained ‡∏ö‡∏ô 6.4M ‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å GitHub (6 ‡∏†‡∏≤‡∏©‡∏≤‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°)
    - ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏±‡πâ‡∏á natural language ‡πÅ‡∏•‡∏∞ programming language
    - Architecture: 12-layer Transformer, 768 hidden size, 12 attention heads
    - Token vocabulary: ~50,000 tokens

### **Siamese Network Architecture**

‡πÇ‡∏°‡πÄ‡∏î‡∏• `SiameseCodeBERT` ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≠‡∏á‡∏ä‡∏∏‡∏î:

1. **Shared Encoder:** ‡πÇ‡∏°‡πÄ‡∏î‡∏• CodeBERT ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Encoder ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ä‡∏∏‡∏î (code1 ‡πÅ‡∏•‡∏∞ code2) ‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (Weight Sharing) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Embedding ‡πÉ‡∏ô‡∏õ‡∏£‡∏¥‡∏†‡∏π‡∏°‡∏¥ (Space) ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
2. **Input:** ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Normalization ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏ñ‡∏π‡∏Å Tokenize ‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà CodeBERT
3. **Pooling:** Output ‡∏à‡∏≤‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á CodeBERT (Last Hidden State) ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏°‡∏≤‡∏ó‡∏≥ **Mean Pooling** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Embedding Vector ‡∏Ç‡∏ô‡∏≤‡∏î 768 ‡∏°‡∏¥‡∏ï‡∏¥ ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á snippet
4. **Similarity Learning:** ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ Cosine Similarity ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ô‡∏µ‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì **‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Absolute** ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Embedding Vector ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡πâ‡∏≠‡∏ô‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà Classification Head (‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏±‡πâ‡∏ô `Linear`, `ReLU`, `Dropout`) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏π‡πà‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (Output ‡∏ú‡πà‡∏≤‡∏ô `Sigmoid`)

```markdown
class SiameseCodeBERT(nn.Module):
    def __init__(self, encoder):
        self.encoder = encoder  # CodeBERT (shared)
        self.classifier = nn.Sequential(
            nn.Linear(768, 256),    # Compress embedding
            nn.ReLU(),              # Non-linearity
            nn.Dropout(0.1),        # Regularization
            nn.Linear(256, 1),      # Binary classification
            nn.Sigmoid()            # Output [0, 1]
        )
```

### **Mean Pooling Strategy**

**Mean Pooling**¬†= ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏£‡πâ‡∏≤‡∏á embedding ‡∏Ç‡∏≠‡∏á code/text sequence ‡πÇ‡∏î‡∏¢‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á hidden states ‡∏ó‡∏∏‡∏Å token (‡∏´‡∏•‡∏±‡∏á encode ‡∏î‡πâ‡∏ß‡∏¢ CodeBERT/Transformer) ‡πÇ‡∏î‡∏¢ ‡∏ñ‡πà‡∏ß‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏î‡πâ‡∏ß‡∏¢ attention mask ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤ padding ‡∏°‡∏≤‡∏Ñ‡∏¥‡∏î

### **‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏™‡∏≠‡∏ô (Training Process)**

- **Epochs:** 3
- **Batch Size:** 16
- **Learning Rate:** 2e-5
- **Loss Function:** `Binary Cross-Entropy Loss (BCELoss)` ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô Binary Classification
- **Optimizer:** `AdamW`
- **Scheduler:** `Linear schedule with warmup` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏°‡∏µ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏†‡∏≤‡∏û

‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡πÇ‡∏î‡∏¢‡∏°‡∏µ Accuracy ‡∏ö‡∏ô Validation Set ‡∏™‡∏π‡∏á‡∏ñ‡∏∂‡∏á **97.8%** ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î Epoch ‡∏ó‡∏µ‡πà 3

# Inference and Evaluation

### **‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Embeddings**

‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô Inference ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô Encoder ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• `SiameseCodeBERT` ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£ Fine-tuning ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Embedding Vector ‡∏Ç‡∏ô‡∏≤‡∏î 768 ‡∏°‡∏¥‡∏ï‡∏¥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏∏‡∏î

### **‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á**

- ‡∏ô‡∏≥ Embedding Vector ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 7.1 ‡∏°‡∏≤‡∏ó‡∏≥ **L2 Normalization**
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì **Cosine Similarity** ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Vector ‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏π‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏•‡∏∂‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á [-1, 1] (‡πÅ‡∏ï‡πà‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏°‡∏±‡∏Å‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô [0, 1] ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ)
Similarity=cos(Œ∏)=‚à•A‚à•‚à•B‚à• / A‚ãÖB

### **‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Threshold ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°**

- ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Similarity ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÅ‡∏ö‡∏ö Binary (Plagiarism/Original) ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ Threshold
- ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Threshold ‡∏à‡∏≤‡∏Å **Validation Set** ‡πÇ‡∏î‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ **F1-Score ‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î** ‡∏ã‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ **0.615**

### **‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏ö‡∏ô Test Set**

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ Threshold ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∂‡∏á‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö **Test Set** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠:

- **Accuracy:** 93.93%
- **Precision:** 92.52%
- **Recall:** 95.60%
- **F1-Score:** 94.03%
- **AUC:** 98.92%

‡∏Ñ‡πà‡∏≤ F1-Score ‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡∏ñ‡∏∂‡∏á 94% ‡∏ö‡∏ô Test Set ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î C++


# C++ Plagiarism Detection with Siamese CodeBERT & Tree-sitter

This project implements a robust source code plagiarism detection system for C++ using a **Siamese Network architecture** backed by **CodeBERT**. It combines semantic analysis (embeddings) with structural analysis (Abstract Syntax Tree via **Tree-sitter**) to accurately detect code clones.

The model achieves an **F1-Score of 94.03%** on the POJ-104 dataset, significantly outperforming traditional regex-based approaches.

## üöÄ Key Features
* **Semantic Detection:** Uses a fine-tuned Siamese CodeBERT model to capture the semantic meaning of code logic.
* **Structural Analysis:** Leverages **Tree-sitter** for precise Abstract Syntax Tree (AST) extraction, overcoming the limitations of regex-based parsing.
* **Siamese Architecture:** Implements a shared-weight encoder with Mean Pooling to generate comparable embedding vectors.
* **Robust Preprocessing:** Includes code normalization (comment removal, whitespace reduction, keyword standardization).

## üìä Performance
Evaluation on the held-out Test Set (1,500 pairs):

| Metric | Score |
| :--- | :--- |
| **Accuracy** | **93.93%** |
| **F1-Score** | **94.03%** |
| **Precision** | 92.52% |
| **Recall** | 95.60% |
| **AUC** | 98.92% |

## üõ†Ô∏è Methodology

### 1. Data Preparation (POJ-104)
We utilized the **POJ-104** dataset from Google's CodeXGLUE benchmark.
* **Pairing Strategy:** Generated **10,000 pairs** balanced 50/50 between Clones (same problem) and Non-clones (different problems).
* **Splitting:** Train (70%), Validation (15%), Test (15%).

### 2. Preprocessing & Feature Engineering
* **Normalization:** Code is normalized to remove noise (comments, formatting) while preserving logic.
* **AST Extraction:** We compared Regex-based AST vs. Tree-sitter. **Tree-sitter** was selected for its superior precision in handling complex nested structures and improved F1-scores during preliminary tests (reducing False Negatives from 139 to 85).

### 3. Model Architecture
* **Base Model:** `microsoft/codebert-base` (Pre-trained on 6 languages).
* **Architecture:** Siamese Network with a Shared Encoder.
* **Pooling:** Mean Pooling of the last hidden states (weighted by attention masks).
* **Similarity:** Trained using a classification head on absolute vector differences; Inference uses **Cosine Similarity**.

## üíª Tech Stack
* **Languages:** Python, C++
* **Deep Learning:** PyTorch, Transformers (Hugging Face)
* **Parsing:** Tree-sitter
* **Data Handling:** Pandas, NumPy, Scikit-learn
* **Visualization:** Matplotlib, Seaborn

## üìà Results: Regex vs. Tree-sitter
We validated the necessity of a proper parser. Tree-sitter proved to be significantly more reliable than Regex pattern matching for structural features:

| Metric | Regex AST | Tree-sitter AST |
| :--- | :--- | :--- |
| **F1-Score** | 0.734 | **0.763** |
| **Recall** | 0.893 | **0.825** |
| **Accuracy** | 0.657 | **0.728** |

## ‚öôÔ∏è How to Run
*(Optional: Add your installation steps here, e.g.)*
1. Install dependencies: `pip install torch transformers datasets tree-sitter`
2. Prepare dataset: `python preprocess.py`
3. Train model: `python train.py`
4. Evaluate: `python evaluate.py`
